@page "{id:int}"
@model SteadyGrowth.Web.Areas.Admin.Pages.Settings.Currency.HistoryModel
@{
    ViewData["Title"] = "Exchange Rate History";
}

<div class="d-flex flex-column flex-column-fluid">
    <div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
        <div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
            <div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
                <h1 class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">Exchange Rate History</h1>
                <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
                    <li class="breadcrumb-item text-muted">
                        <a href="/Admin" class="text-muted text-hover-primary">Admin</a>
                    </li>
                    <li class="breadcrumb-item">
                        <span class="bullet bg-gray-400 w-5px h-2px"></span>
                    </li>
                    <li class="breadcrumb-item text-muted">
                        <a href="/Admin/Settings" class="text-muted text-hover-primary">Settings</a>
                    </li>
                    <li class="breadcrumb-item">
                        <span class="bullet bg-gray-400 w-5px h-2px"></span>
                    </li>
                    <li class="breadcrumb-item text-muted">
                        <a href="/Admin/Settings/Currency" class="text-muted text-hover-primary">Currency Management</a>
                    </li>
                    <li class="breadcrumb-item">
                        <span class="bullet bg-gray-400 w-5px h-2px"></span>
                    </li>
                    <li class="breadcrumb-item text-muted">@Model.Currency?.Code History</li>
                </ul>
            </div>
            <div class="d-flex align-items-center gap-2 gap-lg-3">
                <a href="/Admin/Settings/Currency/Edit/@Model.Currency?.Id" class="btn btn-sm fw-bold btn-primary">
                    <i class="ki-duotone ki-pencil fs-2"></i>Edit Currency
                </a>
            </div>
        </div>
    </div>

    <div id="kt_app_content" class="app-content flex-column-fluid">
        <div id="kt_app_content_container" class="app-container container-xxl">
            <div class="card">
                <div class="card-header border-0 pt-6">
                    <div class="card-title">
                        <h3>@Model.Currency?.Code (@Model.Currency?.Name) - Exchange Rate History</h3>
                    </div>
                    <div class="card-toolbar">
                        <div class="d-flex align-items-center">
                            <span class="badge badge-light-primary fs-7 fw-bold me-3">
                                Current Rate: @Model.Currency?.ExchangeRate.ToString("N6")
                            </span>
                        </div>
                    </div>
                </div>

                <div class="card-body py-4">
                    @if (Model.ExchangeRates.Any())
                    {
                        <table class="table align-middle table-row-dashed fs-6 gy-5">
                            <thead>
                                <tr class="text-start text-muted fw-bold fs-7 text-uppercase gs-0">
                                    <th class="min-w-125px">Effective Date</th>
                                    <th class="min-w-100px">Exchange Rate</th>
                                    <th class="min-w-125px">End Date</th>
                                    <th class="min-w-200px">Notes</th>
                                    <th class="min-w-125px">Created By</th>
                                    <th class="min-w-125px">Created At</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-600 fw-semibold">
                                @foreach (var rate in Model.ExchangeRates)
                                {
                                    <tr>
                                        <td>
                                            <span class="text-gray-800 fw-bold">@rate.EffectiveDate.ToString("MMM dd, yyyy HH:mm")</span>
                                        </td>
                                        <td>
                                            <span class="badge badge-light-info">@rate.Rate.ToString("N6")</span>
                                        </td>
                                        <td>
                                            @if (rate.EndDate.HasValue)
                                            {
                                                <span class="text-muted">@rate.EndDate.Value.ToString("MMM dd, yyyy HH:mm")</span>
                                            }
                                            else
                                            {
                                                <span class="badge badge-light-success">Current</span>
                                            }
                                        </td>
                                        <td>
                                            @if (!string.IsNullOrEmpty(rate.Notes))
                                            {
                                                <span class="text-gray-700">@rate.Notes</span>
                                            }
                                            else
                                            {
                                                <span class="text-muted">-</span>
                                            }
                                        </td>
                                        <td>
                                            @if (!string.IsNullOrEmpty(rate.CreatedBy))
                                            {
                                                <span class="text-gray-700">@rate.CreatedBy</span>
                                            }
                                            else
                                            {
                                                <span class="text-muted">System</span>
                                            }
                                        </td>
                                        <td>
                                            <span class="text-muted">@rate.CreatedAt.ToString("MMM dd, yyyy HH:mm")</span>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                    else
                    {
                        <div class="text-center py-10">
                            <div class="text-gray-400 fs-1 mb-5">
                                <i class="ki-duotone ki-chart-line-down">
                                    <span class="path1"></span>
                                    <span class="path2"></span>
                                </i>
                            </div>
                            <h3 class="text-gray-800 fw-semibold mb-2">No exchange rate history found</h3>
                            <p class="text-gray-600 mb-5">There are no exchange rate records for this currency yet.</p>
                        </div>
                    }
                </div>

                <div class="card-footer d-flex justify-content-start py-6 px-9">
                    <a href="/Admin/Settings/Currency" class="btn btn-light btn-active-light-primary">Back to Currency List</a>
                </div>
            </div>
        </div>
    </div>
</div>